{%- if section.settings.layout == 'default' -%}
{%- assign layout = settings.baseLayout -%}
{%- else -%}
{%- assign layout = section.settings.layout -%}
{%- endif -%}

{% assign root_url = routes.root_url %}
{% assign search_url = root_url | append: 'search' %}
{% if root_url != '/' %}
    {% assign search_url = root_url | append: '/search' %}
{% endif %}

{% assign megamenus = '' %}

{% for block in section.blocks %}
    {% if block.settings.menuItem != '' %}
        {% assign megamenus = megamenus | append: block.settings.menuItem %}
    
        {% unless forloop.last %}
            {% assign megamenus = megamenus | append: ',' %}
        {% endunless %}
    {% endif %}
{% endfor %}

{% assign linkSize = linklists[section.settings.menuLinks].links | size %}
{% assign autoLayoutOn = section.settings.autoLayoutOn %}

<style>
    {% render 'header__common-css', section: section, layout: layout %}

    .page__header {
        min-height: max(var(--height), 4em);
    }

    .page__header--desktop-auto-layout {
        flex-direction: column;
    }

    .page__header--desktop-auto-layout .page__header--width:first-child {
        min-height: max(var(--height), 4em);
    }

    @media screen and (min-width: 768px){
        .header__element--width {
            width: 100%;
            max-width: var(--logoWidth);
        }

        .main__navigation > .nav__link__holder > .nav__link {
            align-items: center;
            min-height: max(var(--height), 4em);
        }
    }
</style>

<div data-search-container class="search__container--abs">
    <div class="search__overlay" onclick="BoosterTheme.ELEMENTS.closeSearch(this)"></div>
    <div class="search__container--wrapper">
        <h4 class="h-reset search__title">{{'general.search.heading' | t}} <span onclick="BoosterTheme.ELEMENTS.closeSearch(this)">{% render 'get-icon', icon: 'close' %}</span></h4>
        <form method="get" action="{{search_url}}">
            <button type="submit" class="search__icon--submit" aria-label="Search">{% render 'get-icon', icon: 'search' %}</button>
            <input autocomplete="off" placeholder="{{'general.search.placeholder' | t }}" name="q" onfocus="BoosterTheme.ELEMENTS.openSearch(this)" type="search" data-search>
        </form>
    </div>
    <div class="search__results search__results--abs" data-search-suggest>
    </div>
</div>

<header class="page__header page__header--desktop {% if template == "index" and section.settings.transparent %}page__header--transparent{% endif %}{% if autoLayoutOn > 0 and linkSize >= autoLayoutOn %} page__header--desktop-auto-layout{% endif %}">
    <div class="page__header--width">
        <div class="header__logo header__element--width">
            {% render 'logo' with section as section %}
        </div>

        <nav class="main__navigation main__navigation--center main__navigation--{{section.settings.hoverStyle}} font__size--{{-section.settings.fontSize}}">
            {% unless autoLayoutOn > 0 and linkSize >= autoLayoutOn %}
                {% for link in linklists[section.settings.menuLinks].links %}
                    {% if link.links.size > 0 %}{% capture submenu %}{% render 'header--link-submenu', link: link, megamenus: megamenus %}{% endcapture %}{% else %}{% assign submenu = '' %}{% endif %}
                    <span class="nav__link__holder {% if link.active or link.child_active %}nav__link--active{% endif %} {% if submenu contains 'nav__submenu--regular' %}nav__link__holder--regular{% endif %}">
                        <a class="nav__link nav__link--{{section.settings.hoverStyle}}" href="{{link.url}}">{% render 'header--link-tag' with link.title as text %}</a>
                        {{submenu}}
                    </span>
                {% endfor %}
            {% endunless %}
        </nav>
        <div class="header__element--width header__utility">
            {% render 'header__general--utility', showCart: section.settings.desktopCart, loginPopup: section.settings.loginPopup %}
        </div>
    </div>

    {% if autoLayoutOn > 0 and linkSize >= autoLayoutOn %}
        <div class="page__header--width">
            <nav class="main__navigation main__navigation--center main__navigation--{{section.settings.hoverStyle}} font__size--{{-section.settings.fontSize}}">
                {% for link in linklists[section.settings.menuLinks].links %}
                    {% if link.links.size > 0 %}{% capture submenu %}{% render 'header--link-submenu', link: link, megamenus: megamenus %}{% endcapture %}{% else %}{% assign submenu = '' %}{% endif %}
                    <span class="nav__link__holder {% if link.active or link.child_active %}nav__link--active{% endif %} {% if submenu contains 'nav__submenu--regular' %}nav__link__holder--regular{% endif %}">
                        <a class="nav__link nav__link--{{section.settings.hoverStyle}}" href="{{link.url}}">{% render 'header--link-tag' with link.title as text %}</a>
                        {{submenu}}
                    </span>
                {% endfor %}
            </nav>
        </div>
    {% endif %}
</header>

{% if section.settings.loginPopup %}
    {% render 'login-popup' %}
{% endif %}

<header class="page__header page__header--mobile hide-desktop {% if template == "index" and section.settings.transparent %}page__header--transparent{% endif %}">
    <div class="page__header--width">
        {% unless section.settings.logoTopMobile %}
        <label class="mobile-submenu-label" for="open-mobile-nav">
            <i class="uil uil-{{-section.settings.menu_icon}}"></i>
        </label>
        {% endunless %}
        <div class="header__logo header__element--width">
            {% render 'logo' with section as section %}
        </div>
        <input id="open-mobile-nav" type="checkbox" style="display: none">
        <label for="open-mobile-nav" class="overlay overlay--nav"></label>
        <nav class="mobile__navigation">
            <label class="close-mobile-nav" for="open-mobile-nav"><span>{% render 'get-icon', icon: 'close' %}</span></label>
            {% for link in linklists[section.settings.menuLinks].links %}
                <span class="nav__link__holder">
                    <a class="nav__link {% if link.active or link.child_active %}nav__link--active{% endif %}" href="{{link.url}}">{% render 'header--link-tag' with link.title as text %}</a>
                    {% if link.links.size > 0 %}
                        <input type="checkbox" style="display: none" id="mobile-submenu-{{forloop.index}}">
                        <label class="mobile__submenu__toggle" for="mobile-submenu-{{forloop.index}}"><i class="uil uil-plus"></i><i class="uil uil-minus"></i></label>
                        {% render 'header--link-submenu--mobile', link: link, ix: forloop.index %}
                    {% else %}
                    
                    {% endif %}
                </span>
            {% endfor %}
            <div class="mobile__navigation__footer">
                {% render 'header__mobile--footer', loginPopup: section.settings.loginPopup %}
            </div>
        </nav>
        {% if section.settings.logoTopMobile %}
        <label class="mobile-submenu-label" for="open-mobile-nav">
            <i class="uil uil-{{-section.settings.menu_icon}}"></i>
        </label>
        {% endif %}
        <div class="header__utility">
        {% render 'header__general--utility', mobile: true, showCart: section.settings.mobileCart  %}
        </div>
    </div>
</header>

{% render 'header__common-js' with section as section %}


{% schema %}
{
  "name": "Header - Default",
  "settings": [
    {
        "type": "header",
        "content": "Global header settings"
    },
    {
      "type": "select",
      "id": "layout",
      "label": "Section layout",
      "options": [
        {"value": "default", "label": "Global default"},
        {"value": "boxed", "label": "Boxed"},
        {"value": "stretchBg", "label": "Full width background"},
        {"value": "stretchContent", "label": "Full width"}
      ],
      "default": "default"
    },
    {
        "type": "range",
        "label": "Height",
        "id": "minHeight",
        "min": 75,
        "max": 150,
        "step": 5,
        "unit": "px",
        "default": 75
    },
    {
        "type": "range",
        "label": "Border radius",
        "id": "borderRadius",
        "min": 0,
        "max": 50,
        "step": 1,
        "unit": "px",
        "default": 0
    },
    {
        "type": "checkbox",
        "id": "shadow",
        "label": "Enable shadow",
        "default": false
    },
    {
        "type": "link_list",
        "id": "menuLinks",
        "label": "Menu links"
    },
    {
        "type": "range",
        "id": "autoLayoutOn",
        "min": 0,
        "max": 20,
        "step": 1,
        "label": "Auto layout navigation",
        "default": 10,
        "info": "The navigation will automatically change its layout if the menu links get too large, based on the size you set here. Set it to 0 to turn this feature off."
    },
    {
        "type": "range",
        "label": "Logo width",
        "id": "logoWidth",
        "min": 50,
        "max": 300,
        "step": 5,
        "unit": "px",
        "default": 240
    },
    {
        "type": "range",
        "label": "Logo height",
        "id": "logoHeight",
        "min": 0,
        "max": 500,
        "step": 5,
        "unit": "px",
        "default": 0,
        "info": "Maximum logo height. If set to 0 (zero) it will take up as much space as needed."
    },
    {
        "type": "checkbox",
        "id": "sticky",
        "label": "Make the header stick to top",
        "default": true
    },
    {
        "type": "range",
        "label": "Content margin",
        "id": "contentMargin",
        "min": 0,
        "max": 200,
        "step": 5,
        "unit": "px",
        "default": 0
    },
    {
        "type": "header",
        "content": "Header buttons"
    },    
    {
        "type": "checkbox",
        "id": "loginPopup",
        "label": "Enable Login Popup",
        "default": false
    },
    {
        "type": "checkbox",
        "id": "desktopCart",
        "label": "Show Cart (desktop)",
        "default": true
    },
    {
        "type": "color",
        "label": "Background color",
        "default": "rgba(0,0,0,0)",
        "id": "headerBg"
    },
    {
        "type": "color_background",
        "id": "headerLinearBg",
        "label": "Linear Background color",
        "info": "Make sure you clear the gradient color if you want to use the default background color."
    },
    {
        "type": "header",
        "content": "Link style"
    },
    {
        "type": "color",
        "id": "linkColor",
        "label": "Text color",
        "default": "#727272"
    },
    {
        "type": "color",
        "id": "accentColor",
        "label": "Active accent color",
        "default": "#000000"
    },
    {
        "type": "select",
        "id": "hoverStyle",
        "label": "Hover style",
        "options": [
            {"value": "fill", "label": "Fill"},
            {"value": "underline", "label": "Underline"},
            {"value": "opacity", "label": "Opacity"},
            {"value": "strikethrough", "label": "Line through text"},
            {"value": "dotBelow", "label": "Dot below"},
            {"value": "dotAbove", "label": "Dot above"}
        ],
        "default": "underline"
    },
    {
        "type": "color",
        "id": "tagBgColor",
        "label": "Tag color",
        "default": "#000"
    },
    {
        "type": "color",
        "id": "tagTextColor",
        "label": "Tag text color",
        "default": "#FFF"
    },
    {
        "id": "transparent",
        "label": "Make the header transparent",
        "type": "checkbox",
        "default": false
    },
    {
        "type": "color",
        "id": "linkColorT",
        "label": "Text color (transparent)",
        "default": "#FFF"
    },
    {
        "type": "color",
        "id": "accentColorT",
        "label": "Active accent color (transparent)",
        "default": "#EFEFEF"
    },
    {
        "id": "fontSize",
        "type": "select",
        "label": "Font size",
        "options": [
            {"value": "small", "label": "Small"},
            {"value": "base", "label": "Base"},
            {"value": "medium", "label": "Medium"},
            {"value": "big", "label": "Big"}
        ],
        "default": "base"
    },
    {
        "type": "checkbox",
        "label": "Use a custom font family",
        "id": "customFont",
        "default": false
    },
    {
        "id": "fontFamily",
        "label": "Font Family",
        "type": "font_picker",
        "default": "work_sans_n6"
    },
    {
        "type": "header",
        "content": "Menu Icon"
    },
    {
        "type": "text",
        "id": "menu_icon",
        "label": "Menu Icon",
        "default": "bars"
    },
    {
        "type": "paragraph",
        "content": "Please Insert the icon name [Click here to View Available Icons](https://iconscout.com/unicons/free-line-icons)"
    },
    {
        "type": "header",
        "content": "Cart"
    },
    {
        "type": "select",
        "label": "Cart icon",
        "id": "cartIcon",
        "options": [
            {"value": "shopping-bag", "label": "Bag"},
            {"value": "shopping-cart", "label": "Cart"},
            {"value": "shopping-basket", "label": "Basket"}
        ],
        "default": "shopping-basket"
    },
    {
        "type": "header",
        "content": "Mobile menu"
    },
    {
        "type": "checkbox",
        "label": "Show cart icon (mobile)",
        "id": "mobileCart",
        "default": true
    },
    {
        "type": "checkbox",
        "id": "logoTopMobile",
        "label": "Make the header logo top on mobile",
        "default": false
    },
    {
        "type": "select",
        "label": "Logo position (mobile)",
        "options": [
            {"value": "left", "label": "Left"},
            {"value": "center", "label": "Center"},
            {"value": "right", "label": "Right"}
        ],
        "default": "center",
        "id": "mobileLogoPosition"
    }
  ],
  "blocks": [
    {
        "type": "megamenu",
        "name": "Mega menu",
        "settings": [
            {
                "type": "header",
                "content": "Mega menu",
                "info": "The mega menu is displayed on desktop only."
            },
            {
                "type": "text",
                "id": "menuItem",
                "label": "Menu item",
                "info": "Enter the name of the menu item you'd like to apply a mega menu. Format should be in lowercase and kebab-case. Example: home, sale, best-seller"
            },
            {
                "type": "checkbox",
                "id": "narrow",
                "label": "Make mega menu narrow",
                "default": true
            },
            {
                "type": "checkbox",
                "id": "showImage",
                "label": "Show mega menu images",
                "default": true
            },
            {
                "type": "header",
                "content": "Promotion 1"
            },
            {
                "type": "image_picker",
                "id": "image1",
                "label": "Image"
            },
            {
                "type": "select",
                "id": "image1ratio",
                "label": "Image ratio",
                "options": [
                    {
                    "value": "adapt",
                    "label": "Adapt to image"
                    },
                    {
                    "value": "square",
                    "label": "Square"
                    },
                    {
                    "value": "portrait",
                    "label": "Portrait"
                    },
                    {
                    "value": "landscape",
                    "label": "Landscape"
                    },
                    {
                    "value": "wide",
                    "label": "Wide"
                    }
                ],
                "default": "adapt"
            },
            {
                "type": "select",
                "id": "image1Focal",
                "label": "Image focal point",
                "options": [
                    {
                    "value": "top left",
                    "label": "Top left"
                    },
                    {
                    "value": "top center",
                    "label": "Top center"
                    },
                    {
                    "value": "top right",
                    "label": "Top right"
                    },
                    {
                    "value": "left",
                    "label": "Left"
                    },
                    {
                    "value": "center",
                    "label": "Center"
                    },
                    {
                    "value": "right",
                    "label": "Right"
                    },
                    {
                    "value": "bottom left",
                    "label": "Bottom left"
                    },
                    {
                    "value": "bottom center",
                    "label": "Bottom center"
                    },
                    {
                    "value": "bottom right",
                    "label": "Bottom right"
                    }
                ],
                "default": "center",
                "info": "Used to keep the subject of your image in view."
            },
            {
                "type": "text",
                "id": "image1heading",
                "label": "Heading"
            },
            {
                "type": "text",
                "id": "image1description",
                "label": "Description"
            },
            {
                "type": "checkbox",
                "id": "image1overlay",
                "label": "Overlay text on image",
                "default": false
            },
            {
                "type": "url",
                "id": "image1url",
                "label": "Link"
            },
            {
                "type": "checkbox",
                "id": "image1urlOpenNewTab",
                "label": "Open in new tab",
                "default": false
            },
            {
                "type": "header",
                "content": "Promotion 2"
            },
            {
                "type": "image_picker",
                "id": "image2",
                "label": "Image"
            },
            {
                "type": "select",
                "id": "image2ratio",
                "label": "Image ratio",
                "options": [
                    {
                    "value": "adapt",
                    "label": "Adapt to image"
                    },
                    {
                    "value": "square",
                    "label": "Square"
                    },
                    {
                    "value": "portrait",
                    "label": "Portrait"
                    },
                    {
                    "value": "landscape",
                    "label": "Landscape"
                    },
                    {
                    "value": "wide",
                    "label": "Wide"
                    }
                ],
                "default": "adapt"
            },
            {
                "type": "select",
                "id": "image2Focal",
                "label": "Image focal point",
                "options": [
                    {
                    "value": "top left",
                    "label": "Top left"
                    },
                    {
                    "value": "top center",
                    "label": "Top center"
                    },
                    {
                    "value": "top right",
                    "label": "Top right"
                    },
                    {
                    "value": "left",
                    "label": "Left"
                    },
                    {
                    "value": "center",
                    "label": "Center"
                    },
                    {
                    "value": "right",
                    "label": "Right"
                    },
                    {
                    "value": "bottom left",
                    "label": "Bottom left"
                    },
                    {
                    "value": "bottom center",
                    "label": "Bottom center"
                    },
                    {
                    "value": "bottom right",
                    "label": "Bottom right"
                    }
                ],
                "default": "center",
                "info": "Used to keep the subject of your image in view."
            },
            {
                "type": "text",
                "id": "image2heading",
                "label": "Heading"
            },
            {
                "type": "text",
                "id": "image2description",
                "label": "Description"
            },
            {
                "type": "checkbox",
                "id": "image2overlay",
                "label": "Overlay text on image",
                "default": false
            },
            {
                "type": "url",
                "id": "image2url",
                "label": "Link"
            },
            {
                "type": "checkbox",
                "id": "image2urlOpenNewTab",
                "label": "Open in new tab",
                "default": false
            },
        ]
    },
  ]
  
}
{% endschema %}